\documentclass{article}

\usepackage{fontspec}
\setmainfont{GFS Artemisia}

\usepackage{luacode} 

% Here we go: A new unicode \bcode command

\begin{luacode*}
    function betacode2utf(t)

        -- uppercase length 5
        t = string.gsub(t, [[%*%(/|A]], [[?]])
        t = string.gsub(t, [[%*%(/|a]], [[?]])
        t = string.gsub(t, [[%*%(/|H]], [[?]])
        t = string.gsub(t, [[%*%(/|h]], [[?]])
        t = string.gsub(t, [[%*%(/|W]], [[?]])
        t = string.gsub(t, [[%*%(/|w]], [[?]])
        t = string.gsub(t, [[%*%(=|A]], [[?]])
        t = string.gsub(t, [[%*%(=|a]], [[?]])
        t = string.gsub(t, [[%*%(=|H]], [[?]])
        t = string.gsub(t, [[%*%(=|h]], [[?]])
        t = string.gsub(t, [[%*%(=|W]], [[?]])
        t = string.gsub(t, [[%*%(=|w]], [[?]])
        t = string.gsub(t, [[%*%(\|A]], [[?]])
        t = string.gsub(t, [[%*%(\|a]], [[?]])
        t = string.gsub(t, [[%*%(\|H]], [[?]])
        t = string.gsub(t, [[%*%(\|h]], [[?]])
        t = string.gsub(t, [[%*%(\|W]], [[?]])
        t = string.gsub(t, [[%*%(\|w]], [[?]])
        t = string.gsub(t, [[%*%)/|A]], [[?]])
        t = string.gsub(t, [[%*%)/|a]], [[?]])
        t = string.gsub(t, [[%*%)/|H]], [[?]])
        t = string.gsub(t, [[%*%)/|h]], [[?]])
        t = string.gsub(t, [[%*%)/|W]], [[?]])
        t = string.gsub(t, [[%*%)/|w]], [[?]])
        t = string.gsub(t, [[%*%)=|A]], [[?]])
        t = string.gsub(t, [[%*%)=|a]], [[?]])
        t = string.gsub(t, [[%*%)=|H]], [[?]])
        t = string.gsub(t, [[%*%)=|h]], [[?]])
        t = string.gsub(t, [[%*%)=|W]], [[?]])
        t = string.gsub(t, [[%*%)=|w]], [[?]])

        -- uppercase length 4
        t = string.gsub(t, [[%*%(/A]], [[?]])
        t = string.gsub(t, [[%*%(/a]], [[?]])
        t = string.gsub(t, [[%*%(/E]], [[?]])
        t = string.gsub(t, [[%*%(/e]], [[?]])
        t = string.gsub(t, [[%*%(/H]], [[?]])
        t = string.gsub(t, [[%*%(/h]], [[?]])
        t = string.gsub(t, [[%*%(/I]], [[?]])
        t = string.gsub(t, [[%*%(/i]], [[?]])
        t = string.gsub(t, [[%*%(/O]], [[?]])
        t = string.gsub(t, [[%*%(/o]], [[?]])
        t = string.gsub(t, [[%*%(/U]], [[?]])
        t = string.gsub(t, [[%*%(/u]], [[?]])
        t = string.gsub(t, [[%*%(/W]], [[?]])
        t = string.gsub(t, [[%*%(/w]], [[?]])
        t = string.gsub(t, [[%*%(=A]], [[?]])
        t = string.gsub(t, [[%*%(=a]], [[?]])
        t = string.gsub(t, [[%*%(=H]], [[?]])
        t = string.gsub(t, [[%*%(=h]], [[?]])
        t = string.gsub(t, [[%*%(=I]], [[?]])
        t = string.gsub(t, [[%*%(=i]], [[?]])
        t = string.gsub(t, [[%*%(=U]], [[?]])
        t = string.gsub(t, [[%*%(=u]], [[?]])
        t = string.gsub(t, [[%*%(=W]], [[?]])
        t = string.gsub(t, [[%*%(=w]], [[?]])
        t = string.gsub(t, [[%*%(\A]], [[?]])
        t = string.gsub(t, [[%*%(\a]], [[?]])
        t = string.gsub(t, [[%*%(\E]], [[?]])
        t = string.gsub(t, [[%*%(\e]], [[?]])
        t = string.gsub(t, [[%*%(\H]], [[?]])
        t = string.gsub(t, [[%*%(\h]], [[?]])
        t = string.gsub(t, [[%*%(\I]], [[?]])
        t = string.gsub(t, [[%*%(\i]], [[?]])
        t = string.gsub(t, [[%*%(\O]], [[?]])
        t = string.gsub(t, [[%*%(\o]], [[?]])
        t = string.gsub(t, [[%*%(\U]], [[?]])
        t = string.gsub(t, [[%*%(\u]], [[?]])
        t = string.gsub(t, [[%*%(\W]], [[?]])
        t = string.gsub(t, [[%*%(\w]], [[?]])
        t = string.gsub(t, [[%*%(|A]], [[?]])
        t = string.gsub(t, [[%*%(|a]], [[?]])
        t = string.gsub(t, [[%*%(|H]], [[?]])
        t = string.gsub(t, [[%*%(|h]], [[?]])
        t = string.gsub(t, [[%*%(|W]], [[?]])
        t = string.gsub(t, [[%*%(|w]], [[?]])
        t = string.gsub(t, [[%*%)/A]], [[?]])
        t = string.gsub(t, [[%*%)/a]], [[?]])
        t = string.gsub(t, [[%*%)/E]], [[?]])
        t = string.gsub(t, [[%*%)/e]], [[?]])
        t = string.gsub(t, [[%*%)/H]], [[?]])
        t = string.gsub(t, [[%*%)/h]], [[?]])
        t = string.gsub(t, [[%*%)/I]], [[?]])
        t = string.gsub(t, [[%*%)/i]], [[?]])
        t = string.gsub(t, [[%*%)/O]], [[?]])
        t = string.gsub(t, [[%*%)/o]], [[?]])
        t = string.gsub(t, [[%*%)/W]], [[?]])
        t = string.gsub(t, [[%*%)/w]], [[?]])
        t = string.gsub(t, [[%*%)=A]], [[?]])
        t = string.gsub(t, [[%*%)=a]], [[?]])
        t = string.gsub(t, [[%*%)=H]], [[?]])
        t = string.gsub(t, [[%*%)=h]], [[?]])
        t = string.gsub(t, [[%*%)=I]], [[?]])
        t = string.gsub(t, [[%*%)=i]], [[?]])
        t = string.gsub(t, [[%*%)=W]], [[?]])
        t = string.gsub(t, [[%*%)=w]], [[?]])
        t = string.gsub(t, [[%*%)\E]], [[?]])
        t = string.gsub(t, [[%*%)\e]], [[?]])
        t = string.gsub(t, [[%*%)\I]], [[?]])
        t = string.gsub(t, [[%*%)\i]], [[?]])
        t = string.gsub(t, [[%*%)\O]], [[?]])
        t = string.gsub(t, [[%*%)\o]], [[?]])
        t = string.gsub(t, [[%*%)|A]], [[?]])
        t = string.gsub(t, [[%*%)|a]], [[?]])
        t = string.gsub(t, [[%*%)|H]], [[?]])
        t = string.gsub(t, [[%*%)|h]], [[?]])
        t = string.gsub(t, [[%*%)|W]], [[?]])
        t = string.gsub(t, [[%*%)|w]], [[?]])

        -- uppercase length 3
        t = string.gsub(t, [[%*%(A]], [[?]])
        t = string.gsub(t, [[%*%(a]], [[?]])
        t = string.gsub(t, [[%*%(E]], [[?]])
        t = string.gsub(t, [[%*%(e]], [[?]])
        t = string.gsub(t, [[%*%(H]], [[?]])
        t = string.gsub(t, [[%*%(h]], [[?]])
        t = string.gsub(t, [[%*%(I]], [[?]])
        t = string.gsub(t, [[%*%(i]], [[?]])
        t = string.gsub(t, [[%*%(O]], [[?]])
        t = string.gsub(t, [[%*%(o]], [[?]])
        t = string.gsub(t, [[%*%(U]], [[?]])
        t = string.gsub(t, [[%*%(u]], [[?]])
        t = string.gsub(t, [[%*%(W]], [[?]])
        t = string.gsub(t, [[%*%(w]], [[?]])
        t = string.gsub(t, [[%*%)A]], [[?]])
        t = string.gsub(t, [[%*%)a]], [[?]])
        t = string.gsub(t, [[%*%)E]], [[?]])
        t = string.gsub(t, [[%*%)e]], [[?]])
        t = string.gsub(t, [[%*%)H]], [[?]])
        t = string.gsub(t, [[%*%)h]], [[?]])
        t = string.gsub(t, [[%*%)I]], [[?]])
        t = string.gsub(t, [[%*%)i]], [[?]])
        t = string.gsub(t, [[%*%)O]], [[?]])
        t = string.gsub(t, [[%*%)o]], [[?]])
        t = string.gsub(t, [[%*%)W]], [[?]])
        t = string.gsub(t, [[%*%)w]], [[?]])
        t = string.gsub(t, [[%*%+I]], [[?]])
        t = string.gsub(t, [[%*%+i]], [[?]])
        t = string.gsub(t, [[%*%+U]], [[?]])
        t = string.gsub(t, [[%*%+u]], [[?]])
        t = string.gsub(t, [[%*/A]], [[?]])
        t = string.gsub(t, [[%*/a]], [[?]])
        t = string.gsub(t, [[%*/E]], [[?]])
        t = string.gsub(t, [[%*/e]], [[?]])
        t = string.gsub(t, [[%*/H]], [[?]])
        t = string.gsub(t, [[%*/h]], [[?]])
        t = string.gsub(t, [[%*/I]], [[?]])
        t = string.gsub(t, [[%*/i]], [[?]])
        t = string.gsub(t, [[%*/O]], [[?]])
        t = string.gsub(t, [[%*/o]], [[?]])
        t = string.gsub(t, [[%*/U]], [[?]])
        t = string.gsub(t, [[%*/u]], [[?]])
        t = string.gsub(t, [[%*/W]], [[?]])
        t = string.gsub(t, [[%*/w]], [[?]])
        t = string.gsub(t, [[%*\A]], [[?]])
        t = string.gsub(t, [[%*\a]], [[?]])
        t = string.gsub(t, [[%*\E]], [[?]])
        t = string.gsub(t, [[%*\e]], [[?]])
        t = string.gsub(t, [[%*\H]], [[?]])
        t = string.gsub(t, [[%*\h]], [[?]])
        t = string.gsub(t, [[%*\I]], [[?]])
        t = string.gsub(t, [[%*\i]], [[?]])
        t = string.gsub(t, [[%*\O]], [[?]])
        t = string.gsub(t, [[%*\o]], [[?]])
        t = string.gsub(t, [[%*\U]], [[?]])
        t = string.gsub(t, [[%*\u]], [[?]])
        t = string.gsub(t, [[%*\W]], [[?]])
        t = string.gsub(t, [[%*\w]], [[?]])
        t = string.gsub(t, [[%*S1]], [[?]])
        t = string.gsub(t, [[%*s1]], [[?]])
        t = string.gsub(t, [[%*S2]], [[?]])
        t = string.gsub(t, [[%*s2]], [[?]])
        t = string.gsub(t, [[%*S3]], [[?]])
        t = string.gsub(t, [[%*s3]], [[?]])
        t = string.gsub(t, [[%*|A]], [[?]])
        t = string.gsub(t, [[%*|a]], [[?]])
        t = string.gsub(t, [[%*|H]], [[?]])
        t = string.gsub(t, [[%*|h]], [[?]])
        t = string.gsub(t, [[%*|W]], [[?]])
        t = string.gsub(t, [[%*|w]], [[?]])

        -- uppercase length 2
        t = string.gsub(t, [[%*A]], [[?]])
        t = string.gsub(t, [[%*a]], [[?]])
        t = string.gsub(t, [[%*B]], [[?]])
        t = string.gsub(t, [[%*b]], [[?]])
        t = string.gsub(t, [[%*C]], [[?]])
        t = string.gsub(t, [[%*c]], [[?]])
        t = string.gsub(t, [[%*D]], [[?]])
        t = string.gsub(t, [[%*d]], [[?]])
        t = string.gsub(t, [[%*E]], [[?]])
        t = string.gsub(t, [[%*e]], [[?]])
        t = string.gsub(t, [[%*F]], [[?]])
        t = string.gsub(t, [[%*f]], [[?]])
        t = string.gsub(t, [[%*G]], [[?]])
        t = string.gsub(t, [[%*g]], [[?]])
        t = string.gsub(t, [[%*H]], [[?]])
        t = string.gsub(t, [[%*h]], [[?]])
        t = string.gsub(t, [[%*I]], [[?]])
        t = string.gsub(t, [[%*i]], [[?]])
        t = string.gsub(t, [[%*J]], [[?]])
        t = string.gsub(t, [[%*j]], [[?]])
        t = string.gsub(t, [[%*K]], [[?]])
        t = string.gsub(t, [[%*k]], [[?]])
        t = string.gsub(t, [[%*L]], [[?]])
        t = string.gsub(t, [[%*l]], [[?]])
        t = string.gsub(t, [[%*M]], [[?]])
        t = string.gsub(t, [[%*m]], [[?]])
        t = string.gsub(t, [[%*N]], [[?]])
        t = string.gsub(t, [[%*n]], [[?]])
        t = string.gsub(t, [[%*O]], [[?]])
        t = string.gsub(t, [[%*o]], [[?]])
        t = string.gsub(t, [[%*P]], [[?]])
        t = string.gsub(t, [[%*p]], [[?]])
        t = string.gsub(t, [[%*Q]], [[?]])
        t = string.gsub(t, [[%*q]], [[?]])
        t = string.gsub(t, [[%*R]], [[?]])
        t = string.gsub(t, [[%*r]], [[?]])
        t = string.gsub(t, [[%*S]], [[?]])
        t = string.gsub(t, [[%*s]], [[?]])
        t = string.gsub(t, [[%*T]], [[?]])
        t = string.gsub(t, [[%*t]], [[?]])
        t = string.gsub(t, [[%*U]], [[?]])
        t = string.gsub(t, [[%*u]], [[?]])
        t = string.gsub(t, [[%*W]], [[?]])
        t = string.gsub(t, [[%*w]], [[?]])
        t = string.gsub(t, [[%*X]], [[?]])
        t = string.gsub(t, [[%*x]], [[?]])
        t = string.gsub(t, [[%*Y]], [[?]])
        t = string.gsub(t, [[%*y]], [[?]])
        t = string.gsub(t, [[%*Z]], [[?]])
        t = string.gsub(t, [[%*z]], [[?]])

        -- lowercase length 4
        t = string.gsub(t, [[A%(/|]], [[?]])
        t = string.gsub(t, [[a%(/|]], [[?]])
        t = string.gsub(t, [[A%(=|]], [[?]])
        t = string.gsub(t, [[a%(=|]], [[?]])
        t = string.gsub(t, [[A%(=]], [[?]])
        t = string.gsub(t, [[a%(=]], [[?]])
        t = string.gsub(t, [[A%(\|]], [[?]])
        t = string.gsub(t, [[A%)/|]], [[?]])
        t = string.gsub(t, [[a%)/|]], [[?]])
        t = string.gsub(t, [[A%)=|]], [[?]])
        t = string.gsub(t, [[a%)=|]], [[?]])
        t = string.gsub(t, [[H%(/|]], [[?]])
        t = string.gsub(t, [[h%(/|]], [[?]])
        t = string.gsub(t, [[H%(=|]], [[?]])
        t = string.gsub(t, [[h%(=|]], [[?]])
        t = string.gsub(t, [[H%(=]], [[?]])
        t = string.gsub(t, [[h%(=]], [[?]])
        t = string.gsub(t, [[H%(\|]], [[?]])
        t = string.gsub(t, [[h%(\|]], [[?]])
        t = string.gsub(t, [[H%)/|]], [[?]])
        t = string.gsub(t, [[h%)/|]], [[?]])
        t = string.gsub(t, [[H%)=|]], [[?]])
        t = string.gsub(t, [[h%)=|]], [[?]])
        t = string.gsub(t, [[W%(/|]], [[?]])
        t = string.gsub(t, [[w%(/|]], [[?]])
        t = string.gsub(t, [[W%(=|]], [[?]])
        t = string.gsub(t, [[w%(=|]], [[?]])
        t = string.gsub(t, [[W%(=]], [[?]])
        t = string.gsub(t, [[w%(=]], [[?]])
        t = string.gsub(t, [[W%(\|]], [[?]])
        t = string.gsub(t, [[w%(\|]], [[?]])
        t = string.gsub(t, [[W%)/|]], [[?]])
        t = string.gsub(t, [[w%)/|]], [[?]])
        t = string.gsub(t, [[W%)=|]], [[?]])
        t = string.gsub(t, [[w%)=|]], [[?]])

        -- lowercase length 3
        t = string.gsub(t, [[A%(/]], [[?]])
        t = string.gsub(t, [[a%(/]], [[?]])
        t = string.gsub(t, [[A%(\]], [[?]])
        t = string.gsub(t, [[a%(\]], [[?]])
        t = string.gsub(t, [[A%(|]], [[?]])
        t = string.gsub(t, [[a%(|]], [[?]])
        t = string.gsub(t, [[A%)/]], [[?]])
        t = string.gsub(t, [[a%)/]], [[?]])
        t = string.gsub(t, [[A%)=]], [[?]])
        t = string.gsub(t, [[a%)=]], [[?]])
        t = string.gsub(t, [[A%)\]], [[?]])
        t = string.gsub(t, [[a%)\]], [[?]])
        t = string.gsub(t, [[A%)|]], [[?]])
        t = string.gsub(t, [[a%)|]], [[?]])
        t = string.gsub(t, [[A/|]], [[?]])
        t = string.gsub(t, [[a/|]], [[?]])
        t = string.gsub(t, [[A=|]], [[?]])
        t = string.gsub(t, [[a=|]], [[?]])
        t = string.gsub(t, [[A\|]], [[?]])
        t = string.gsub(t, [[a\|]], [[?]])
        t = string.gsub(t, [[E%(/]], [[?]])
        t = string.gsub(t, [[e%(/]], [[?]])
        t = string.gsub(t, [[E%(\]], [[?]])
        t = string.gsub(t, [[e%(\]], [[?]])
        t = string.gsub(t, [[E%)/]], [[?]])
        t = string.gsub(t, [[e%)/]], [[?]])
        t = string.gsub(t, [[E%)\]], [[?]])
        t = string.gsub(t, [[e%)\]], [[?]])
        t = string.gsub(t, [[H%(/]], [[?]])
        t = string.gsub(t, [[h%(/]], [[?]])
        t = string.gsub(t, [[H%(\]], [[?]])
        t = string.gsub(t, [[h%(\]], [[?]])
        t = string.gsub(t, [[H%(|]], [[?]])
        t = string.gsub(t, [[h%(|]], [[?]])
        t = string.gsub(t, [[H%)/]], [[?]])
        t = string.gsub(t, [[h%)/]], [[?]])
        t = string.gsub(t, [[H%)=]], [[?]])
        t = string.gsub(t, [[h%)=]], [[?]])
        t = string.gsub(t, [[H%)|]], [[?]])
        t = string.gsub(t, [[h%)|]], [[?]])
        t = string.gsub(t, [[H/|]], [[?]])
        t = string.gsub(t, [[h/|]], [[?]])
        t = string.gsub(t, [[H=|]], [[?]])
        t = string.gsub(t, [[h=|]], [[?]])
        t = string.gsub(t, [[H\|]], [[?]])
        t = string.gsub(t, [[h\|]], [[?]])
        t = string.gsub(t, [[I%(/]], [[?]])
        t = string.gsub(t, [[i%(/]], [[?]])
        t = string.gsub(t, [[I%(=]], [[?]])
        t = string.gsub(t, [[i%(=]], [[?]])
        t = string.gsub(t, [[I%(\]], [[?]])
        t = string.gsub(t, [[i%(\]], [[?]])
        t = string.gsub(t, [[I%)/]], [[?]])
        t = string.gsub(t, [[i%)/]], [[?]])
        t = string.gsub(t, [[I%)=]], [[?]])
        t = string.gsub(t, [[i%)=]], [[?]])
        t = string.gsub(t, [[I%)\]], [[?]])
        t = string.gsub(t, [[i%)\]], [[?]])
        t = string.gsub(t, [[O%(/]], [[?]])
        t = string.gsub(t, [[o%(/]], [[?]])
        t = string.gsub(t, [[O%(\]], [[?]])
        t = string.gsub(t, [[o%(\]], [[?]])
        t = string.gsub(t, [[O%)/]], [[?]])
        t = string.gsub(t, [[o%)/]], [[?]])
        t = string.gsub(t, [[O%)\]], [[?]])
        t = string.gsub(t, [[o%)\]], [[?]])
        t = string.gsub(t, [[U%(/]], [[?]])
        t = string.gsub(t, [[u%(/]], [[?]])
        t = string.gsub(t, [[U%(=]], [[?]])
        t = string.gsub(t, [[u%(=]], [[?]])
        t = string.gsub(t, [[U%(\]], [[?]])
        t = string.gsub(t, [[u%(\]], [[?]])
        t = string.gsub(t, [[U%)/]], [[?]])
        t = string.gsub(t, [[u%)/]], [[?]])
        t = string.gsub(t, [[U%)=]], [[?]])
        t = string.gsub(t, [[u%)=]], [[?]])
        t = string.gsub(t, [[U%)\]], [[?]])
        t = string.gsub(t, [[u%)\]], [[?]])
        t = string.gsub(t, [[W%(/]], [[?]])
        t = string.gsub(t, [[w%(/]], [[?]])
        t = string.gsub(t, [[W%(\]], [[?]])
        t = string.gsub(t, [[w%(\]], [[?]])
        t = string.gsub(t, [[W%(|]], [[?]])
        t = string.gsub(t, [[w%(|]], [[?]])
        t = string.gsub(t, [[W%)/]], [[?]])
        t = string.gsub(t, [[w%)/]], [[?]])
        t = string.gsub(t, [[W%)=]], [[?]])
        t = string.gsub(t, [[w%)=]], [[?]])
        t = string.gsub(t, [[W%)|]], [[?]])
        t = string.gsub(t, [[w%)|]], [[?]])
        t = string.gsub(t, [[W/|]], [[?]])
        t = string.gsub(t, [[w/|]], [[?]])
        t = string.gsub(t, [[W=|]], [[?]])
        t = string.gsub(t, [[w=|]], [[?]])
        t = string.gsub(t, [[W\|]], [[?]])
        t = string.gsub(t, [[w\|]], [[?]])

        -- lowercase length 2
        t = string.gsub(t, [[A%(]], [[?]])
        t = string.gsub(t, [[a%(]], [[?]])
        t = string.gsub(t, [[A%)]], [[?]])
        t = string.gsub(t, [[a%)]], [[?]])
        t = string.gsub(t, [[A/]], [[?]])
        t = string.gsub(t, [[a/]], [[?]])
        t = string.gsub(t, [[A=]], [[?]])
        t = string.gsub(t, [[a=]], [[?]])
        t = string.gsub(t, [[A\]], [[?]])
        t = string.gsub(t, [[a\]], [[?]])
        t = string.gsub(t, [[A|]], [[?]])
        t = string.gsub(t, [[a|]], [[?]])
        t = string.gsub(t, [[E%(]], [[?]])
        t = string.gsub(t, [[e%(]], [[?]])
        t = string.gsub(t, [[E%)]], [[?]])
        t = string.gsub(t, [[e%)]], [[?]])
        t = string.gsub(t, [[E/]], [[?]])
        t = string.gsub(t, [[e/]], [[?]])
        t = string.gsub(t, [[E\]], [[?]])
        t = string.gsub(t, [[e\]], [[?]])
        t = string.gsub(t, [[H%(]], [[?]])
        t = string.gsub(t, [[h%(]], [[?]])
        t = string.gsub(t, [[H%)]], [[?]])
        t = string.gsub(t, [[h%)]], [[?]])
        t = string.gsub(t, [[H/]], [[?]])
        t = string.gsub(t, [[h/]], [[?]])
        t = string.gsub(t, [[H=]], [[?]])
        t = string.gsub(t, [[h=]], [[?]])
        t = string.gsub(t, [[H\]], [[?]])
        t = string.gsub(t, [[h\]], [[?]])
        t = string.gsub(t, [[H|]], [[?]])
        t = string.gsub(t, [[h|]], [[?]])
        t = string.gsub(t, [[I%(]], [[?]])
        t = string.gsub(t, [[i%(]], [[?]])
        t = string.gsub(t, [[I%)]], [[?]])
        t = string.gsub(t, [[i%)]], [[?]])
        t = string.gsub(t, [[I/]], [[?]])
        t = string.gsub(t, [[i/]], [[?]])
        t = string.gsub(t, [[I=]], [[?]])
        t = string.gsub(t, [[i=]], [[?]])
        t = string.gsub(t, [[I\]], [[?]])
        t = string.gsub(t, [[i\]], [[?]])
        t = string.gsub(t, [[O%(]], [[?]])
        t = string.gsub(t, [[o%(]], [[?]])
        t = string.gsub(t, [[O%)]], [[?]])
        t = string.gsub(t, [[o%)]], [[?]])
        t = string.gsub(t, [[O/]], [[?]])
        t = string.gsub(t, [[o/]], [[?]])
        t = string.gsub(t, [[O\]], [[?]])
        t = string.gsub(t, [[o\]], [[?]])
        t = string.gsub(t, [[S1]], [[?]])
        t = string.gsub(t, [[s1]], [[?]])
        t = string.gsub(t, [[S2]], [[?]])
        t = string.gsub(t, [[s2]], [[?]])
        t = string.gsub(t, [[S3]], [[?]])
        t = string.gsub(t, [[s3]], [[?]])
        t = string.gsub(t, [[U%(]], [[?]])
        t = string.gsub(t, [[u%(]], [[?]])
        t = string.gsub(t, [[U%)]], [[?]])
        t = string.gsub(t, [[u%)]], [[?]])
        t = string.gsub(t, [[U/]], [[?]])
        t = string.gsub(t, [[u/]], [[?]])
        t = string.gsub(t, [[U=]], [[?]])
        t = string.gsub(t, [[u=]], [[?]])
        t = string.gsub(t, [[U\]], [[?]])
        t = string.gsub(t, [[u\]], [[?]])
        t = string.gsub(t, [[W%(]], [[?]])
        t = string.gsub(t, [[w%(]], [[?]])
        t = string.gsub(t, [[W%)]], [[?]])
        t = string.gsub(t, [[w%)]], [[?]])
        t = string.gsub(t, [[W/]], [[?]])
        t = string.gsub(t, [[w/]], [[?]])
        t = string.gsub(t, [[W=]], [[?]])
        t = string.gsub(t, [[w=]], [[?]])
        t = string.gsub(t, [[W\]], [[?]])
        t = string.gsub(t, [[w\]], [[?]])
        t = string.gsub(t, [[W|]], [[?]])
        t = string.gsub(t, [[w|]], [[?]])

        -- lowercase length 1
        t = string.gsub(t, [[A]], [[?]])
        t = string.gsub(t, [[a]], [[?]])
        t = string.gsub(t, [[B]], [[?]])
        t = string.gsub(t, [[b]], [[?]])
        t = string.gsub(t, [[C]], [[?]])
        t = string.gsub(t, [[c]], [[?]])
        t = string.gsub(t, [[D]], [[?]])
        t = string.gsub(t, [[d]], [[?]])
        t = string.gsub(t, [[E]], [[?]])
        t = string.gsub(t, [[e]], [[?]])
        t = string.gsub(t, [[F]], [[?]])
        t = string.gsub(t, [[f]], [[?]])
        t = string.gsub(t, [[G]], [[?]])
        t = string.gsub(t, [[g]], [[?]])
        t = string.gsub(t, [[H]], [[?]])
        t = string.gsub(t, [[h]], [[?]])
        t = string.gsub(t, [[I]], [[?]])
        t = string.gsub(t, [[i]], [[?]])
        t = string.gsub(t, [[J]], [[?]])
        t = string.gsub(t, [[j]], [[?]])
        t = string.gsub(t, [[K]], [[?]])
        t = string.gsub(t, [[k]], [[?]])
        t = string.gsub(t, [[L]], [[?]])
        t = string.gsub(t, [[l]], [[?]])
        t = string.gsub(t, [[M]], [[?]])
        t = string.gsub(t, [[m]], [[?]])
        t = string.gsub(t, [[N]], [[?]])
        t = string.gsub(t, [[n]], [[?]])
        t = string.gsub(t, [[O]], [[?]])
        t = string.gsub(t, [[o]], [[?]])
        t = string.gsub(t, [[P]], [[?]])
        t = string.gsub(t, [[p]], [[?]])
        t = string.gsub(t, [[Q]], [[?]])
        t = string.gsub(t, [[q]], [[?]])
        t = string.gsub(t, [[R]], [[?]])
        t = string.gsub(t, [[r]], [[?]])
        t = string.gsub(t, [[S]], [[?]])
        t = string.gsub(t, [[s]], [[?]])
        t = string.gsub(t, [[T]], [[?]])
        t = string.gsub(t, [[t]], [[?]])
        t = string.gsub(t, [[U]], [[?]])
        t = string.gsub(t, [[u]], [[?]])
        t = string.gsub(t, [[W]], [[?]])
        t = string.gsub(t, [[w]], [[?]])
        t = string.gsub(t, [[X]], [[?]])
        t = string.gsub(t, [[x]], [[?]])
        t = string.gsub(t, [[Y]], [[?]])
        t = string.gsub(t, [[y]], [[?]])
        t = string.gsub(t, [[Z]], [[?]])
        t = string.gsub(t, [[z]], [[?]])

        t = string.gsub(t, [[%(]], [[?]])
        t = string.gsub(t, [[%)]], [[?]])
        t = string.gsub(t, [[/]], [?]])
        t = string.gsub(t, [[:]], [[·]])
        t = string.gsub(t, [[=]], [[?]])
        t = string.gsub(t, [[_]], [[?]])
        t = string.gsub(t, [[\]], [[`]])

        -- sigma specials
        t = string.gsub(t, [[?$]], [[?]])
        t = string.gsub(t, [[(?)(%s)]], [[?%2]])
        t = string.gsub(t, [[(?)(%p)]], [[?%2]])
        t = string.gsub(t, [[(?)(·)]], [[?%2]])
        t = string.gsub(t, [[(?)(?)]], [[?%2]])

        tex.print(t)
    end
\end{luacode*}

\begingroup
\catcode`\$0
$catcode`$\12
$catcode`$_12
$makeatletter
$gdef$bcode{$begingroup $catcode`$\12 $catcode`$_12 $bcode@i}
$gdef$bcode@i#1{%
    $endgroup
    $directlua{betacode2utf([[#1]])}
}
$endgroup

\begin{document}

Something short: \bcode{lo/gos, ei)=dos. ei)=dos; ei)=dos: lo/gos}

Something longer:
\bcode{
    kate/bhn xqe\s ei)s *peiraia= meta\ *glau/kwnos tou= *)ari/stwnos proseuco/meno/s te th=| qew=| kai\ a(/ma th\n e(orth\n boulo/menos qea/sasqai ti/na tro/pon poih/sousin a(/te nu=n prw=ton a)/gontes. kalh\ me\n ou)=n moi kai\ h( tw=n e)pixwri/wn pomph\ e)/docen ei)=nai, ou) me/ntoi h(=tton e)fai/neto pre/pein h(\n oi( *qra=|kes e)/pempon. proseuca/menoi de\ kai\ qewrh/santes a)ph=|men pro\s to\ a)/stu. katidw\n ou)=n po/rrwqen h(ma=s oi)/kade w(rmhme/nous *pole/marxos o( *kefa/lou e)ke/leuse dramo/nta to\n pai=da perimei=nai/ e( keleu=sai. kai/ mou o)/pisqen o( pai=s labo/menos tou= i(mati/ou, keleu/ei u(ma=s, e)/fh, *pole/marxos perimei=nai. kai\ e)gw\ metestra/fhn te kai\ h)ro/mhn o(/pou au)to\s ei)/h. ou(=tos, e)/fh, o)/pisqen prose/rxetai: a)lla\ perime/nete. a)lla\ perimenou=men, h)= d' o(\s o( *glau/kwn.
}
\end{document}